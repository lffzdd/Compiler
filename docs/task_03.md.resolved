# 📋 编译器学习任务跟踪

## 总体进度

| 阶段 | 状态 | 说明 |
|:----:|:----:|:-----|
| 1 | ✅ 完成 | 词法分析 |
| 2 | ✅ 完成 | 语法分析 |
| 3 | ✅ 完成 | 语义分析 |
| 4 | ⏳ 待开始 | 中间代码生成 |
| 5 | ⏳ 待开始 | 代码优化 |
| 6 | ⏳ 待开始 | 目标代码生成 |
| 7 | ⏳ 待开始 | 链接与执行 |

---

## 阶段3：语义分析 ✅

### 已完成
- [x] 语义分析器结构设计 ([include/semantic.h](file:///d:/Projects/C/Compiler/include/semantic.h))
  - [x] DataType 枚举（int, float, char, void...）
  - [x] Symbol 结构体（变量/函数信息）
  - [x] Scope 结构体（作用域+符号哈希表）
  - [x] SemanticAnalyzer 结构体
- [x] 语义分析器实现 ([src/semantic.c](file:///d:/Projects/C/Compiler/src/semantic.c))
  - [x] 符号表管理（声明、查找）
  - [x] 作用域栈（进入/退出作用域）
  - [x] 类型检查和类型兼容性
  - [x] 表达式类型推导
  - [x] 错误收集和报告
- [x] 测试用例全部通过

### 学习要点
1. **符号表**：记录所有声明的变量和函数
2. **作用域**：变量的可见范围，从内向外查找
3. **类型检查**：确保操作数类型兼容

### 检测的错误类型
| 错误 | 示例 |
|:-----|:-----|
| 未声明变量 | `x = 5;` (x 未声明) |
| 重复声明 | `int x; int x;` |
| 未声明函数 | `foo();` (foo 未定义) |
| 参数数量错误 | [add(1)](file:///d:/Projects/C/Compiler/test_file/test_simple.c#3-4) (add 需要2个参数) |
| 类型不兼容 | `int x = "hello";` |

---

## 文件结构

```
Compiler/
├── include/
│   ├── token.h       # ✅ Token 类型
│   ├── lexer.h       # ✅ 词法分析器
│   ├── ast.h         # ✅ AST 节点
│   ├── parser.h      # ✅ 语法分析器
│   └── semantic.h    # ✅ 语义分析器
├── src/
│   ├── token.c       # ✅ Token 函数
│   ├── lexer.c       # ✅ 词法分析
│   ├── ast.c         # ✅ AST 操作
│   ├── parser.c      # ✅ 语法分析
│   └── semantic.c    # ✅ 语义分析
├── main.c            # ✅ 主程序
└── ...
```

---

## 下一步：阶段4 - 中间代码生成

将 AST 转换为三地址码 (IR)，为代码生成做准备。
